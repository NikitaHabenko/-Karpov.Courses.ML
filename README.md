# Академический проект в рамках курса "Start ML" от Karpov.Courses
Задача проекта: 

1. Обучить модель машинного обучения для рекомендаций контента (текстовых постов) пользователям. 
2. Написать сервис рекомендаций на базе FAST API, интегрировать в него обученную модель.
3. Проанализировать результаты A/B теста по сравнению качества двух моделей.


### 1. Работа с признаками и обучение модели 

model_training.ipynb - обработка данных, извлечение признаков, обучение catboost-модели для рекомендательной системы
contro_model - первая версия модели, без использования DL для получения новых признаков
test_model - вторая версия модели, с использованием в обучении признаков полученных из эмбеддингов текстов постов

стек:
pandas, numpy, torch, sklearn, catboost

Для обучения модели был использован content-based подход.
Чтобы обучить модель были выделены признаки, такие как:
пол, возраст, город, среднее количество просматриваемыв постов в день, доля лайкнутых постов к просмотренным и другие - для пользователей
тема, количество символов в посте, tf-idf для текста поста, среднеее дневное количество просмотров и другие - для постов

Для тестовой модели был использовн Bert для получения эмбеддингов из текстов постов, затем метод главных компонент (PCA)
для уменьшения размерности эмбеддингов, затем алгоритм кластеризации sklearn.cluster.AgglomerativeClustering для создания смысловых кластеров.
Далее, эти кластеры были использованы в качестве признаков для обучения тестовой модели.


### 2. Разработка сервиса рекомендаций на базе FAST API

app.py - файл с кодом сервиса 
database.py - подключение к базе данных
schema.py - схемы на pydantic
table_feed.py - реализация классов на языке ORM

стек: 
sqlalchemy, fastapi

в app.py реализована функция "recommended_posts", которая разбивает пользователей на группы и для каждой из групп использует одну из двух реализованных моделей
для получения 5 постов с наибольшей вероятностью получить лайк от пользователя. То есть, когда к нам приходит пользователь, он попадает в одну из двух групп - контрольную или тестовую,
после чего, собранные данные о том как ведут себя пользователи в разных группах мы используем для проведения A/B теста.
(эти данные я не логировал, так как в 3 части проекта для анализа результатов A/B теста использовались данные, предоставляемые преподавателями курса)


### 3. Анализ результатов A/B теста
AB test - юпитер ноутбук с анализом результатов A/B теста

стек:
scipy, statsmodels

В качестве целевой метрики использовался hitrate@5 - доля пользователей, которые поставили лайк хотя бы одному посту из пяти рекомендованных.
Для оценки различия между группами и значимости различий использовался бакетный подход, а в качестве стат. критерия - критерий Манна-Уитни.
